/**
 * Deep Checkbox
 * A lightweight jQuery plugin for building complex nested checkbox trees,
 * complete with its own set of child-parent inheritance logic.
 * version 0.1.1
 *
 * Copyright (c) Semyon Vyskubov
 * https://github.com/uoziod/deep-checkbox
 *
 * Licensed under the MIT
 */
!function(e){function t(n,l){for(var i=[],a=n.find("ul:first > li"),c=0,d=a.length;d>c;c++){var h=e(a[c]).find("input[type=checkbox]:first"),o=r();h.data("id")||h.data("id",o),h.data("name")||h.data("name",o);var f={el:h},s=t(e(a[c]),h);s&&(f.children=s),l&&(f.parent=l),i.push(f)}return i.length>0?i:!1}function n(t,l){for(var r=0,i=t.length;i>r;r++)!function(t){e(t.el).on("change",function(){l(t,e(this).prop("checked"))}),t.children&&n(t.children,l)}(t[r])}function l(e,t){for(var n=0,r=e.length;r>n;n++)e[n].el.prop("checked",t),e[n].children&&l(e[n].children,t)}function r(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var i={listItemBefore:'<span class="item">',listItemAfter:"</span>",listItemsDivider:", ",labelExceptBefore:" (except ",labelExceptAfter:")",labelExceptBetween:", ",labelNothingIsSelected:"Nothing is selected"},a=[];e.fn.deepcheckbox=function(r){if(a.indexOf(this.selector)<0){var c=t(this);n(c,function(e,t){e.children&&l(e.children,t)}),r||(r={}),r=e.extend(i,r),r.readableListTarget&&(e(r.readableListTarget).html(r.labelNothingIsSelected),n(c,function(){function t(e,a,c){a||(a=0);for(var d=0,h=e.length;h>d;d++){if(e[d].el.prop("checked")){var o=r.listItemBefore.replace("{{id}}",e[d].el.data("id"))+e[d].el.data("name"),f=0;if(e[d].children){for(var s=0,p=e[d].children.length;p>s;s++)e[d].children[s].el.prop("checked")||(l.push(e[d].children[s].el.data("id")),0===f&&(o+=r.labelExceptBefore),f>0&&(o+=r.labelExceptBetween),o+=e[d].children[s].el.data("name"),f++);f>0&&(o+=r.labelExceptAfter)}o+=r.listItemAfter,a>0&&e[d].el.prop("checked")&&!e[d].parent.prop("checked")&&(c=!1),(!c||f>0)&&(i.push(o),n.push(e[d].el.data("id")))}e[d].children&&t(e[d].children,a+1,!0)}return i.join(r.listItemsDivider)}var n=[],l=[],i=[],a=t(c);e(r.readableListTarget).html(a.length>0?a:r.labelNothingIsSelected),r.onChange&&"function"==typeof r.onChange&&r.onChange(n,l)})),a.push(this.selector)}}}(jQuery);